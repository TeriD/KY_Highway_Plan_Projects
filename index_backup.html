<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Character encoding and viewport settings for responsive design -              <!-- Export buttons for data download -->
              <div class="export-buttons">
                <button id="downloadCSV" class="btn btn-sm btn-outline-success" title="Download CSV">
                  ðŸ“‹ CSV
                </button>
                <button id="downloadJSON" class="btn btn-sm btn-outline-info" title="Download JSON">
                  ðŸ“‹ JSON
                </button>
                <button id="downloadXLSX" class="btn btn-sm btn-outline-warning" title="Download Excel">
                  ðŸ“‹ Excel
                </button>
              </div>harset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Page title that appears in browser tab -->
  <title>KY Highway Projects Dashboard</title>

  <!-- External CSS dependencies -->
  <!-- Leaflet CSS: Required for interactive maps -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Bootstrap CSS: Provides responsive grid system and styling -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tabulator CSS: Advanced data table styling and functionality -->
  <link href="https://unpkg.com/tabulator-tables@5.4.4/dist/css/tabulator.min.css" rel="stylesheet">
  <!-- Custom CSS: Dashboard-specific styling -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- JavaScript libraries loaded in head -->
  <!-- Chart.js: For creating pie charts and bar charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- SQL.js: For client-side SQLite database operations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
  <!-- Tabulator.js: Advanced data table with sorting, filtering, and export capabilities -->
  <script src="https://unpkg.com/tabulator-tables@5.4.4/dist/js/tabulator.min.js"></script>
  <!-- SheetJS: Required for Excel export functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
  <!-- Header section with dashboard title -->
  <header class="bg-primary text-white p-3 mb-3">
    <div class="container">
      <div class="header-content">
        <h1 class="h4 mb-0">KY Highway Projects Dashboard</h1>
      </div>
    </div>
  </header>

  <!-- Main content container -->
  <main class="container">
    <!-- Dashboard layout container with side panels and map -->
    <div class="dashboard-container">

      <!-- Left-side panels containing charts -->
      <div class="left-panels">

        <!-- Projects Overview Panel: Pie chart showing awarded vs current projects -->
        <div class="panel">
          <h6 class="display-6">Projects</h6>
          <div class="chart-header">
            <div class="chart-main">
              <!-- Total project count display -->
              <div class="total-section">
                <div class="total-count" id="totalProjectCount">0</div>
              </div>
              <!-- Pie chart and legend container -->
              <div class="chart-and-legend">
                <!-- Canvas element for Chart.js pie chart -->
                <div class="chart-container">
                  <canvas id="projectsPieChart"></canvas>
                </div>
                <!-- Custom legend for pie chart -->
                <div class="chart-legend" id="projectsLegend">
                  <!-- Awarded projects legend item -->
                  <div class="legend-item">
                    <span class="legend-color awarded"></span>
                    <span class="legend-label">Awarded</span>
                    <span class="legend-value" id="awardedCount">0</span>
                  </div>
                  <!-- Current projects legend item -->
                  <div class="legend-item">
                    <span class="legend-color current"></span>
                    <span class="legend-label">Current</span>
                    <span class="legend-value" id="currentCount">0</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Project Years Panel: Horizontal bar chart showing project distribution by year -->
        <div class="panel">
          <h6 class="display-6">Project Years</h6>
          <div class="years-chart-container">
            <!-- Canvas element for Chart.js horizontal bar chart -->
            <canvas id="projectYearsChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Main Map Area: Interactive Leaflet map with GeoJSON layers -->
      <div class="main-map-area">
        <div class="map-container">
          <!-- Map container where Leaflet map will be initialized -->
          <div id="map"></div>
        </div>
      </div>
    </div>

    <!-- Database Table Section: Full-width table showing project details -->
    <div class="table-section">
      <div class="table-container">
        <div class="table-content">
          <!-- Table header with title, controls, and export buttons -->
          <div class="table-header">
            <h6 class="mb-3">Highway Projects Data</h6>
            <div class="table-header-controls">
              <!-- Export buttons for data download -->
              <div class="export-buttons">
                <button id="downloadCSV" class="btn btn-sm btn-outline-success" title="Download CSV">
                  ï¿½ CSV
                </button>
                <button id="downloadJSON" class="btn btn-sm btn-outline-info" title="Download JSON">
                  ðŸ“‹ JSON
                </button>
                <button id="downloadXLSX" class="btn btn-sm btn-outline-warning" title="Download Excel">
                  ï¿½ Excel
                </button>
              </div>
              <!-- Database reload button triggers loadDatabase() function -->
              <button id="loadDataBtn" class="btn btn-sm reload-btn" title="Load Database">
                <img src="images/database-reload-icon.svg" alt="Reload" width="16" height="16">
              </button>
            </div>
          </div>

          <!-- Table controls showing record count and pagination info -->
          <div class="table-controls mb-3">
            <span id="recordCount" class="text-muted"></span>
            <span id="paginationInfo" class="text-muted ms-3"></span>
          </div>

          <!-- Tabulator.js table container - replaces traditional HTML table -->
          <!-- This div will be transformed into an advanced data table by Tabulator.js -->
          <div id="highway-projects-table"></div>

          <!-- Fallback message for when JavaScript is disabled -->
          <noscript>
            <div class="alert alert-warning">
              <strong>JavaScript Required:</strong> This table requires JavaScript to display data.
              Please enable JavaScript in your browser to view the highway projects data.
            </div>
          </noscript>
        </div>
      </div>
    </div>
  </main>

  <!-- JavaScript libraries loaded at end of body for better performance -->
  <!-- Leaflet.js: Interactive mapping library -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Custom JavaScript: Dashboard functionality and database operations -->
  <script src="js/script.js"></script>
</body>

</html>